<!DOCTYPE html>
<html>
    <head>
        <title>IAB Content Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
    </head>
    <body>
        <h1>InappBrowser Content</h1>

        <p>Platform: <span id="platform"></span></p>
        <p>InappBrowser Webview: <span id="webview"></span></p>

        <button onclick="onClickPostMessage()">Post Message</button>

        <script type="text/javascript">
            function showPlatformDetails(){
                var webView, platform;
                if (navigator.userAgent.match(/(Android|Chrome)/)) {
                    platform = "Android";
                    if (navigator.userAgent.toLowerCase().indexOf('crosswalk') > -1) {
                        webView = "Crosswalk";
                    } else {
                        webView = "System";
                    }
                } else if (navigator.userAgent.match(/(Apple)/)) {
                    platform = "iOS";
                    if (window.webkit && window.webkit.messageHandlers) {
                        webView = "WKWebView";
                    } else {
                        webView = "UIWebView";
                    }

                }else{
                    webView = platform = "Unknown";
                }
                document.getElementById('platform').innerHTML = platform;
                document.getElementById('webview').innerHTML = webView;
            }

            function onClickPostMessage(){
                postMessage({
                    action: "logout"
                });
            }

            function postMessage(message){
                if(!webkit.messageHandlers.cordova_iab) throw "Cordova IAB postMessage API not found!";
                webkit.messageHandlers.cordova_iab.postMessage(JSON.stringify(message));
            }

            function onReady(){
                console.log("ready");
                showPlatformDetails();
            }

            (function(){
                document.addEventListener('DOMContentLoaded', onReady);
            })();
        </script>
    </body>
    </body>
</html>

